// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id         Int    @id @default(autoincrement())
  name       String @db.VarChar(100)
  email      String @db.VarChar(100) @unique
  password   String @db.VarChar(255)
  pfp        String?@db.Text
  categoryId Int
  balance    Int    @default(0)
  category   Category @relation("CategoryUser", fields: [categoryId], references: [id])
  donationsReceived Donation[] @relation("DonationReceiver")
  donationsSent     Donation[] @relation("DonationSender")
  payouts           Payout[] @relation("PayoutUser")
  milestones        Milestones[] @relation("MilestonesUser")
}

model Category {
  id    Int @id @default(autoincrement())
  name  String @db.VarChar(100)
  users User[] @relation("CategoryUser")
}

model Donation {
  id         Int    @id @default(autoincrement())
  amount     Int    @default(0)  
  senderId   Int?
  senderName String @default("Orang Baik")
  receiverId Int
  message    String @db.Text
  timeCreated DateTime @default(now())
  receiver   User   @relation("DonationReceiver", fields: [receiverId], references: [id])
  sender     User?  @relation("DonationSender", fields: [senderId], references: [id])
}

model Milestones {
  id Int @id @default(autoincrement())
  target Int
  current Int @default(0)
  userId Int
  description String @db.Text
  timecreated DateTime @default(now())
  user User @relation("MilestonesUser", fields: [userId], references: [id])
}

model Payout{
  id Int @id @default(autoincrement())
  amount Int @default(0)
  userId Int
  timecreated DateTime @default(now())
  user User @relation("PayoutUser", fields: [userId], references: [id])
  status String @default("pending")
}
